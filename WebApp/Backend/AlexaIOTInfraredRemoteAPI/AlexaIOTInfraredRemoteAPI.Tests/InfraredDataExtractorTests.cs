using AlexaIOTInfraredRemoteAPI.Domain.Helpers;
using Microsoft.VisualBasic;

namespace AlexaIOTInfraredRemoteAPI.Tests
{
    [TestClass]
    public class InfraredDataExtractorTests
    {
        [TestMethod]
        public void ExtractRawData_ValidData_ReturnsCorrectArray()
        {
            string data =
                "uint16_t rawData[583] = {3426, 1720,  408, 1274,  408, 1274,  406, 434,  404, 434,  404, 434,  404, 1276,  408, 432,  406, 434,  404, 1276,  408, 1272,  408, 430,  408, 1274,  408, 430,  406, 436,  404, 1276,  406, 1274,  408, 434,  402, 1278,  404, 1276,  406, 432,  404, 436,  404, 1272,  408, 434,  406, 430,  406, 1274,  408, 432,  408, 432,  406, 434,  406, 430,  406, 436,  402, 434,  404, 434,  404, 432,  406, 434,  404, 432,  406, 434,  406, 430,  410, 430,  404, 432,  408, 432,  406, 434,  406, 432,  404, 432,  408, 432,  406, 434,  404, 1274,  406, 434,  406, 430,  408, 434,  404, 434,  406, 430,  406, 1274,  406, 434,  406, 432,  406, 432,  406, 434,  404, 1276,  406, 1276,  406, 1274,  408, 1272,  408, 434,  404, 434,  404, 434,  406, 434,  402, 434,  406, 434,  406, 432,  406, 434,  404, 1276,  406, 1276,  406, 436,  404, 432,  406, 434,  406, 434,  404, 434,  404, 432,  406, 434,  402, 434,  406, 1274,  406, 434,  404, 434,  404, 432,  406, 434,  404, 434,  410, 426,  408, 432,  408, 430,  406, 434,  404, 432,  408, 430,  406, 434,  404, 436,  402, 432,  408, 432,  404, 432,  408, 432,  406, 434,  404, 432,  406, 432,  406, 430,  406, 436,  404, 434,  402, 434,  406, 432,  406, 432,  404, 434,  404, 434,  404, 434,  406, 432,  406, 432,  408, 430,  406, 434,  406, 432,  408, 432,  404, 434,  406, 432,  404, 434,  404, 434,  406, 432,  406, 432,  404, 434,  404, 436,  402, 436,  404, 434,  406, 432,  404, 432,  406, 432,  406, 434,  404, 434,  404, 434,  406, 432,  406, 434,  404, 432,  406, 434,  406, 432,  408, 432,  404, 436,  402, 432,  408, 1274,  406, 1274,  408, 1274,  406, 1274,  408, 432,  404, 1274,  406, 13026,  3436, 1722,  406, 1276,  404, 1276,  406, 434,  404, 434,  404, 434,  404, 1274,  408, 434,  406, 434,  406, 1274,  406, 1274,  408, 434,  404, 1274,  406, 434,  408, 432,  404, 1274,  408, 1276,  406, 432,  404, 1274,  406, 1274,  408, 430,  406, 434,  406, 1274,  406, 434,  406, 432,  404, 1276,  408, 432,  406, 432,  406, 432,  404, 434,  404, 434,  406, 434,  406, 432,  406, 434,  404, 434,  406, 432,  406, 432,  404, 434,  404, 434,  404, 434,  404, 432,  406, 436,  404, 432,  404, 434,  408, 430,  408, 432,  404, 1274,  410, 432,  404, 432,  406, 432,  404, 434,  404, 436,  402, 1274,  406, 434,  406, 434,  404, 434,  406, 434,  404, 1274,  408, 1276,  404, 1276,  404, 1274,  408, 432,  404, 434,  404, 432,  406, 432,  406, 436,  402, 434,  404, 434,  406, 434,  404, 1274,  408, 1274,  406, 434,  406, 432,  404, 434,  404, 434,  404, 436,  402, 434,  406, 432,  404, 436,  402, 1274,  406, 434,  404, 434,  404, 434,  406, 436,  402, 436,  402, 434,  406, 432,  406, 434,  404, 434,  406, 432,  406, 434,  404, 434,  404, 434,  404, 434,  404, 434,  404, 432,  406, 434,  404, 434,  404, 434,  404, 438,  402, 432,  404, 434,  406, 432,  404, 436,  404, 434,  404, 434,  404, 436,  404, 432,  406, 434,  404, 432,  404, 434,  406, 434,  404, 436,  404, 432,  404, 436,  404, 432,  404, 436,  404, 434,  404, 436,  404, 436,  404, 432,  404, 436,  404, 434,  404, 434,  408, 430,  404, 434,  406, 434,  402, 434,  404, 434,  404, 436,  402, 434,  404, 434,  406, 434,  404, 434,  404, 436,  402, 434,  402, 440,  404, 428,  404, 438,  402, 1274,  406, 1276,  404, 1276,  406, 1276,  408, 432,  404, 1274,  406};  // MITSUBISHI_AC\r\nuint8_t state[18] = {0x23, 0xCB, 0x26, 0x01, 0x00, 0x20, 0x08, 0x0F, 0x30, 0x40, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xBC};";
            int[] expected = new int[]
            {
                3426, 1720, 408, 1274, 408, 1274, 406, 434, 404, 434, 404, 434, 404, 1276, 408, 432, 406, 434, 404,
                1276, 408, 1272, 408, 430, 408, 1274, 408, 430, 406, 436, 404, 1276, 406, 1274, 408, 434, 402, 1278,
                404, 1276, 406, 432, 404, 436, 404, 1272, 408, 434, 406, 430, 406, 1274, 408, 432, 408, 432, 406, 434,
                406, 430, 406, 436, 402, 434, 404, 434, 404, 432, 406, 434, 404, 432, 406, 434, 406, 430, 410, 430, 404,
                432, 408, 432, 406, 434, 406, 432, 404, 432, 408, 432, 406, 434, 404, 1274, 406, 434, 406, 430, 408,
                434, 404, 434, 406, 430, 406, 1274, 406, 434, 406, 432, 406, 432, 406, 434, 404, 1276, 406, 1276, 406,
                1274, 408, 1272, 408, 434, 404, 434, 404, 434, 406, 434, 402, 434, 406, 434, 406, 432, 406, 434, 404,
                1276, 406, 1276, 406, 436, 404, 432, 406, 434, 406, 434, 404, 434, 404, 432, 406, 434, 402, 434, 406,
                1274, 406, 434, 404, 434, 404, 432, 406, 434, 404, 434, 410, 426, 408, 432, 408, 430, 406, 434, 404,
                432, 408, 430, 406, 434, 404, 436, 402, 432, 408, 432, 404, 432, 408, 432, 406, 434, 404, 432, 406, 432,
                406, 430, 406, 436, 404, 434, 402, 434, 406, 432, 406, 432, 404, 434, 404, 434, 404, 434, 406, 432, 406,
                432, 408, 430, 406, 434, 406, 432, 408, 432, 404, 434, 406, 432, 404, 434, 404, 434, 406, 432, 406, 432,
                404, 434, 404, 436, 402, 436, 404, 434, 406, 432, 404, 432, 406, 432, 406, 434, 404, 434, 404, 434, 406,
                432, 406, 434, 404, 432, 406, 434, 406, 432, 408, 432, 404, 436, 402, 432, 408, 1274, 406, 1274, 408,
                1274, 406, 1274, 408, 432, 404, 1274, 406, 13026, 3436, 1722, 406, 1276, 404, 1276, 406, 434, 404, 434,
                404, 434, 404, 1274, 408, 434, 406, 434, 406, 1274, 406, 1274, 408, 434, 404, 1274, 406, 434, 408, 432,
                404, 1274, 408, 1276, 406, 432, 404, 1274, 406, 1274, 408, 430, 406, 434, 406, 1274, 406, 434, 406, 432,
                404, 1276, 408, 432, 406, 432, 406, 432, 404, 434, 404, 434, 406, 434, 406, 432, 406, 434, 404, 434,
                406, 432, 406, 432, 404, 434, 404, 434, 404, 434, 404, 432, 406, 436, 404, 432, 404, 434, 408, 430, 408,
                432, 404, 1274, 410, 432, 404, 432, 406, 432, 404, 434, 404, 436, 402, 1274, 406, 434, 406, 434, 404,
                434, 406, 434, 404, 1274, 408, 1276, 404, 1276, 404, 1274, 408, 432, 404, 434, 404, 432, 406, 432, 406,
                436, 402, 434, 404, 434, 406, 434, 404, 1274, 408, 1274, 406, 434, 406, 432, 404, 434, 404, 434, 404,
                436, 402, 434, 406, 432, 404, 436, 402, 1274, 406, 434, 404, 434, 404, 434, 406, 436, 402, 436, 402,
                434, 406, 432, 406, 434, 404, 434, 406, 432, 406, 434, 404, 434, 404, 434, 404, 434, 404, 434, 404, 432,
                406, 434, 404, 434, 404, 434, 404, 438, 402, 432, 404, 434, 406, 432, 404, 436, 404, 434, 404, 434, 404,
                436, 404, 432, 406, 434, 404, 432, 404, 434, 406, 434, 404, 436, 404, 432, 404, 436, 404, 432, 404, 436,
                404, 434, 404, 436, 404, 436, 404, 432, 404, 436, 404, 434, 404, 434, 408, 430, 404, 434, 406, 434, 402,
                434, 404, 434, 404, 436, 402, 434, 404, 434, 406, 434, 404, 434, 404, 436, 402, 434, 402, 440, 404, 428,
                404, 438, 402, 1274, 406, 1276, 404, 1276, 406, 1276, 408, 432, 404, 1274, 406
            };

            int[] actual = InfraredDataExtractor.ExtractRawData(data);
            CollectionAssert.AreEqual(expected, actual);
        }

        [TestMethod]
        public void ExtractRawDataWithoutStateArray_ValidData_ReturnsCorrectArray()
        {
            string data =
                "uint16_t rawData[583] = {3426, 1720,  408, 1274,  408, 1274,  406, 434,  404, 434,  404, 434,  404, 1276,  408, 432,  406, 434,  404, 1276,  408, 1272,  408, 430,  408, 1274,  408, 430,  406, 436,  404, 1276,  406, 1274,  408, 434,  402, 1278,  404, 1276,  406, 432,  404, 436,  404, 1272,  408, 434,  406, 430,  406, 1274,  408, 432,  408, 432,  406, 434,  406, 430,  406, 436,  402, 434,  404, 434,  404, 432,  406, 434,  404, 432,  406, 434,  406, 430,  410, 430,  404, 432,  408, 432,  406, 434,  406, 432,  404, 432,  408, 432,  406, 434,  404, 1274,  406, 434,  406, 430,  408, 434,  404, 434,  406, 430,  406, 1274,  406, 434,  406, 432,  406, 432,  406, 434,  404, 1276,  406, 1276,  406, 1274,  408, 1272,  408, 434,  404, 434,  404, 434,  406, 434,  402, 434,  406, 434,  406, 432,  406, 434,  404, 1276,  406, 1276,  406, 436,  404, 432,  406, 434,  406, 434,  404, 434,  404, 432,  406, 434,  402, 434,  406, 1274,  406, 434,  404, 434,  404, 432,  406, 434,  404, 434,  410, 426,  408, 432,  408, 430,  406, 434,  404, 432,  408, 430,  406, 434,  404, 436,  402, 432,  408, 432,  404, 432,  408, 432,  406, 434,  404, 432,  406, 432,  406, 430,  406, 436,  404, 434,  402, 434,  406, 432,  406, 432,  404, 434,  404, 434,  404, 434,  406, 432,  406, 432,  408, 430,  406, 434,  406, 432,  408, 432,  404, 434,  406, 432,  404, 434,  404, 434,  406, 432,  406, 432,  404, 434,  404, 436,  402, 436,  404, 434,  406, 432,  404, 432,  406, 432,  406, 434,  404, 434,  404, 434,  406, 432,  406, 434,  404, 432,  406, 434,  406, 432,  408, 432,  404, 436,  402, 432,  408, 1274,  406, 1274,  408, 1274,  406, 1274,  408, 432,  404, 1274,  406, 13026,  3436, 1722,  406, 1276,  404, 1276,  406, 434,  404, 434,  404, 434,  404, 1274,  408, 434,  406, 434,  406, 1274,  406, 1274,  408, 434,  404, 1274,  406, 434,  408, 432,  404, 1274,  408, 1276,  406, 432,  404, 1274,  406, 1274,  408, 430,  406, 434,  406, 1274,  406, 434,  406, 432,  404, 1276,  408, 432,  406, 432,  406, 432,  404, 434,  404, 434,  406, 434,  406, 432,  406, 434,  404, 434,  406, 432,  406, 432,  404, 434,  404, 434,  404, 434,  404, 432,  406, 436,  404, 432,  404, 434,  408, 430,  408, 432,  404, 1274,  410, 432,  404, 432,  406, 432,  404, 434,  404, 436,  402, 1274,  406, 434,  406, 434,  404, 434,  406, 434,  404, 1274,  408, 1276,  404, 1276,  404, 1274,  408, 432,  404, 434,  404, 432,  406, 432,  406, 436,  402, 434,  404, 434,  406, 434,  404, 1274,  408, 1274,  406, 434,  406, 432,  404, 434,  404, 434,  404, 436,  402, 434,  406, 432,  404, 436,  402, 1274,  406, 434,  404, 434,  404, 434,  406, 436,  402, 436,  402, 434,  406, 432,  406, 434,  404, 434,  406, 432,  406, 434,  404, 434,  404, 434,  404, 434,  404, 434,  404, 432,  406, 434,  404, 434,  404, 434,  404, 438,  402, 432,  404, 434,  406, 432,  404, 436,  404, 434,  404, 434,  404, 436,  404, 432,  406, 434,  404, 432,  404, 434,  406, 434,  404, 436,  404, 432,  404, 436,  404, 432,  404, 436,  404, 434,  404, 436,  404, 436,  404, 432,  404, 436,  404, 434,  404, 434,  408, 430,  404, 434,  406, 434,  402, 434,  404, 434,  404, 436,  402, 434,  404, 434,  406, 434,  404, 434,  404, 436,  402, 434,  402, 440,  404, 428,  404, 438,  402, 1274,  406, 1276,  404, 1276,  406, 1276,  408, 432,  404, 1274,  406};";
            int[] expected = new int[]
            {
                3426, 1720, 408, 1274, 408, 1274, 406, 434, 404, 434, 404, 434, 404, 1276, 408, 432, 406, 434, 404,
                1276, 408, 1272, 408, 430, 408, 1274, 408, 430, 406, 436, 404, 1276, 406, 1274, 408, 434, 402, 1278,
                404, 1276, 406, 432, 404, 436, 404, 1272, 408, 434, 406, 430, 406, 1274, 408, 432, 408, 432, 406, 434,
                406, 430, 406, 436, 402, 434, 404, 434, 404, 432, 406, 434, 404, 432, 406, 434, 406, 430, 410, 430, 404,
                432, 408, 432, 406, 434, 406, 432, 404, 432, 408, 432, 406, 434, 404, 1274, 406, 434, 406, 430, 408,
                434, 404, 434, 406, 430, 406, 1274, 406, 434, 406, 432, 406, 432, 406, 434, 404, 1276, 406, 1276, 406,
                1274, 408, 1272, 408, 434, 404, 434, 404, 434, 406, 434, 402, 434, 406, 434, 406, 432, 406, 434, 404,
                1276, 406, 1276, 406, 436, 404, 432, 406, 434, 406, 434, 404, 434, 404, 432, 406, 434, 402, 434, 406,
                1274, 406, 434, 404, 434, 404, 432, 406, 434, 404, 434, 410, 426, 408, 432, 408, 430, 406, 434, 404,
                432, 408, 430, 406, 434, 404, 436, 402, 432, 408, 432, 404, 432, 408, 432, 406, 434, 404, 432, 406, 432,
                406, 430, 406, 436, 404, 434, 402, 434, 406, 432, 406, 432, 404, 434, 404, 434, 404, 434, 406, 432, 406,
                432, 408, 430, 406, 434, 406, 432, 408, 432, 404, 434, 406, 432, 404, 434, 404, 434, 406, 432, 406, 432,
                404, 434, 404, 436, 402, 436, 404, 434, 406, 432, 404, 432, 406, 432, 406, 434, 404, 434, 404, 434, 406,
                432, 406, 434, 404, 432, 406, 434, 406, 432, 408, 432, 404, 436, 402, 432, 408, 1274, 406, 1274, 408,
                1274, 406, 1274, 408, 432, 404, 1274, 406, 13026, 3436, 1722, 406, 1276, 404, 1276, 406, 434, 404, 434,
                404, 434, 404, 1274, 408, 434, 406, 434, 406, 1274, 406, 1274, 408, 434, 404, 1274, 406, 434, 408, 432,
                404, 1274, 408, 1276, 406, 432, 404, 1274, 406, 1274, 408, 430, 406, 434, 406, 1274, 406, 434, 406, 432,
                404, 1276, 408, 432, 406, 432, 406, 432, 404, 434, 404, 434, 406, 434, 406, 432, 406, 434, 404, 434,
                406, 432, 406, 432, 404, 434, 404, 434, 404, 434, 404, 432, 406, 436, 404, 432, 404, 434, 408, 430, 408,
                432, 404, 1274, 410, 432, 404, 432, 406, 432, 404, 434, 404, 436, 402, 1274, 406, 434, 406, 434, 404,
                434, 406, 434, 404, 1274, 408, 1276, 404, 1276, 404, 1274, 408, 432, 404, 434, 404, 432, 406, 432, 406,
                436, 402, 434, 404, 434, 406, 434, 404, 1274, 408, 1274, 406, 434, 406, 432, 404, 434, 404, 434, 404,
                436, 402, 434, 406, 432, 404, 436, 402, 1274, 406, 434, 404, 434, 404, 434, 406, 436, 402, 436, 402,
                434, 406, 432, 406, 434, 404, 434, 406, 432, 406, 434, 404, 434, 404, 434, 404, 434, 404, 434, 404, 432,
                406, 434, 404, 434, 404, 434, 404, 438, 402, 432, 404, 434, 406, 432, 404, 436, 404, 434, 404, 434, 404,
                436, 404, 432, 406, 434, 404, 432, 404, 434, 406, 434, 404, 436, 404, 432, 404, 436, 404, 432, 404, 436,
                404, 434, 404, 436, 404, 436, 404, 432, 404, 436, 404, 434, 404, 434, 408, 430, 404, 434, 406, 434, 402,
                434, 404, 434, 404, 436, 402, 434, 404, 434, 406, 434, 404, 434, 404, 436, 402, 434, 402, 440, 404, 428,
                404, 438, 402, 1274, 406, 1276, 404, 1276, 406, 1276, 408, 432, 404, 1274, 406
            };

            int[] actual = InfraredDataExtractor.ExtractRawData(data);
            CollectionAssert.AreEqual(expected, actual);
        }

        [TestMethod]
        public void ExtractRawData_InvalidData_ThrowsException()
        {
            string data =
                "uint16_t rawData[583] = {3426, 1720,  408, 1274,  408, 1274,  406, 434,  404, 434,  404, 434,  404, 1276,  408, 432,  406, 434,  404, 1276,  408, 1272,  408, 430,  408, 1274,  408, 430,  406, 436,  404, 1276,  406, 1274,  408, 434,  402, 1278,  404, 1276,  406, 432,  404, 436,  404, 1272,  408, 434,  406, 430,  406, 1274,  408, 432,  408, 432,  406, 434,  406, 430,  406, 436,  402, 434,  404, 434,  404, 432,  406, 434,  404, 432,  406, 434,  406, 430,  410, 430,  404, 432,  408, 432,  406, 434,  406, 432,  404, 432,  408, 432,  406, 434,  404, 1274,  406, 434,  406, 430,  408, 434,  404, 434,  406, 430,  406, 1274,  406, 434,  406, 432,  406, 432,  406, 434,  404, 1276,  406, 1276,  406, 1274,  408, 1272,  408, 434,  404, 434,  404, 434,  406, 434,  402, 434,  406, 434,  406, 432,  406, 434,  404, 1276,  406, 1276,  406, 436,  404, 432,  406, 434,  406, 434,  404, 434,  404, 432,  406, 434,  402, 434,  406, 1274,  406, 434,  404, 434,  404, 432,  406, 434,  404, 434,  410, 426,  408, 432,  408, 430,  406, 434,  404, 432,  408, 430,  406, 434,  404, 436,  402, 432,  408, 432,  404, 432,  408, 432,  406, 434,  404, 432,  406, 432,  406, 430,  406, 436,  404, 434,  402, 434,  406, 432,  406, 432,  404, 434,  404, 434,  404, 434,  406, 432,  406, 432,  408, 430,  406, 434,  406, 432,  408, 432,  404, 434,  406, 432,  404, 434,  404, 434,  406, 432,  406, 432,  404, 434,  404, 436,  402, 436,  404, 434,  406, 432,  404, 432,  406, 432,  406, 434,  404, 434,  404, 434,  406, 432,  406, 434,  404, 432,  406, 434,  406, 432,  408, 432,  404, 436,  402, 432,  408, 1274,  406, 1274,  408, 1274,  406, 1274,  408, 432,  404, 1274,  406, 13026,  3436, 1722,  406, 1276,  404, 1276,  406, 434,  404, 434,  404, 434,  404, 1274,  408, 434,  406, 434,  406, 1274,  406, 1274,  408, 434,  404, 1274,  406, 434,  408, 432,  404, 1274,  408, 1276,  406, 432,  404, 1274,  406, 1274,  408, 430,  406, 434,  406, 1274,  406, 434,  406, 432,  404, 1276,  408, 432,  406, 432,  406, 432,  404, 434,  404, 434,  406, 434,  406, 432,  406, 434,  404, 434,  406, 432,  406, 432,  404, 434,  404, 434,  404, 434,  404, 432,  406, 436,  404, 432,  404, 434,  408, 430,  408, 432,  404, 1274,  410, 432,  404, 432,  406, 432,  404, 434,  404, 436,  402, 1274,  406, 434,  406, 434,  404, 434,  406, 434,  404, 1274,  408, 1276,  404, 1276,  404, 1274,  408, 432,  404, 434,  404, 432,  406, 432,  406, 436,  402, 434,  404, 434,  406, 434,  404, 1274,  408, 1274,  406, 434,  406, 432,  404, 434,  404, 434,  404, 436,  402, 434,  406, 432,  404, 436,  402, 1274,  406, 434,  404, 434,  404, 434,  406, 436,  402, 436,  402, 434,  406, 432,  406, 434,  404, 434,  406, 432,  406, 434,  404, 434,  404, 434,  404, 434,  404, 434,  404, 432,  406, 434,  404, 434,  404, 434,  404, 438,  402, 432,  404, 434,  406, 432,  404, 436,  404, 434,  404, 434,  404, 436,  404, 432,  406, 434,  404, 432,  404, 434,  406, 434,  404, 436,  404, 432,  404, 436,  404, 432,  404, 436,  404, 434,  404, 436,  404, 436,  404, 432,  404, 436,  404, 434,  404, 434,  408, 430,  404, 434,  406, 434,  402, 434,  404, 434,  404, 436,  402, 434,  404, 434,  406, 434,  404, 434,  404, 436,  402, 434,  402, 440,  404, 428,  404, 438,  402, 1274,  406, 1276,  404, 1276,  406, 1276,  408, 432,  404, 1274,  406;";

            Assert.ThrowsException<ArgumentException>(() => InfraredDataExtractor.ExtractRawData(data));
        }
    }
}
